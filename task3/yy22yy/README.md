# 任务三：中山、江门拍地信息采集
## 实现方法和说明
1. python_Qwen大模型；
2. RPA(7.20实现)，使用的是影刀模型；
3. python_普通OCR；
4. 附带selenium无法实现的说明；
5. 注：由于江门市无“土地使用权交易结果公告”，故excel表不显示；

### 一、Python_Qwen大模型(中山市 1-10页 城市页数可选择)
#### 内容
1. video，excel；
2. task3_model.py;(api和key需要自己手动建立config文件);
3. 注意：建立config.py，根据task3_model.py的import创建相应字段和需要的爬取页码范围page_begin-page_end;

#### 实现的结果和原因分析
1. 总共读取到91行；其中存在打开网页时，超过等待10秒未截图的信息(网络卡顿)；
2. 还有存在个别字识别错误(模型精度不高为免费模型)；
3. 因为api调用识别较慢；

### 二、RPA(7.20实现)(中山市 1-4页)
#### 内容
1. 中山市前40行数据.excel文件
2. 爬取前四十行的视频

#### 说明
1. RPA用到了 AI引擎 和 通用文字识别；
2. 只有四十行的原因：调用一次通用文字识别需要一毛钱；资金有限；

### 三、Python_普通OCR(中山市、江门市 7-20页城市页数可选择)
#### 内容
1. video，excel；
2. .py源码;;city_config（城市配置文件，手动输入城市，可以输入多个）;page.py(自定义页面范围)

#### 元素”定位“实现方法
1. 同RPA，无法直接对元素进行定位，选择使用driver截图然后OCR读取；
2. 截图读取用使用模块Pytesseract 是一个基于 Python 的 OCR（光学字符识别）工具，底层使用的是 Google 的 Tesseract-OCR；
3. 读取得到的的rich_text，然后使用正则表达式处理出需要的数据;

#### 任意页数、任意城市实现方法
1. city_config城市配置文件，手动输入城市，可以输入多个,一次性完成；
2. page.py的两个变量page_begin和page_end为对应页码的范围；

#### 实现难点和不足
1. OCR精度：从截图中读取的文字有错别字；
2. 由于1中的误差，正则表达式对字段进行处理时，需要自己考虑误差：如“竞”可能读取成“竟”，导致读取字段为None；
3. 由于使用了OCR读取，读取正确率依赖于读取精度；有结果的答案仍然有错别字；


### 四、selenium无法实现的原因
1. 对于网页的DOM树结构进行分析，发现有shadow-root结点；
2. shadow-root结点状态为closed，无法通过定位方法实现(open可以);
3. 实现思路，模拟网页行为将closed改为open，但是效率不如api逆向，故不选用；
   
## 总结
### 最优实现方法：api逆向
原因：
1. 错误高：不管是普通OCR还是大模型，都存在识别出错别字的问题，对于涉及大量资金的项目，错别字可能引发严重的后果；
2. 风险小：api逆向直接爬取对应数据库的内容，错误概率小；
3. 时间快：api逆向在实现了之后的速度比需要截图和识别的OCR和大模型快；